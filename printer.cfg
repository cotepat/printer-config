#############################################################################################################
### CONFIGURATION GENERATED BY THE RATOS CONFIGURATOR
### Everything below [include RatOS.cfg] will override default RatOS behavior
#############################################################################################################
[include v-cast-idex-RatOS.cfg]

#############################################################################################################
### MACRO CONFIGURATION
### Configure the behavior of RatOS macros
### See: https://os.ratrig.com/docs/configuration/macros
#############################################################################################################
[gcode_macro RatOS]
variable_relative_extrusion: True
variable_preheat_extruder: True
variable_calibrate_bed_mesh: True
variable_nozzle_priming: "primeblob"
variable_start_print_park_in: "front"
variable_start_print_park_z_height: 50
variable_end_print_park_in: "back"
variable_pause_print_park_in: "front"

#############################################################################################################
### USER OVERRIDES & CUSTOM CONFIGURATION
### Anything custom you want to add, or RatOS configuration you want to override, do it here.
### This section is pre-populated with the most common settings you may want to change.
### See: https://os.ratrig.com/docs/configuration/includes-and-overrides
###
### It is recommended that you follow these steps to properly calibrate your printer:
### 0) Sanity check and PID Tuning: https://www.klipper3d.org/Config_checks.html
### 1) Z-offset calibration: https://www.klipper3d.org/Probe_Calibrate.html#calibrating-probe-z-offset
### 2) Pressure Advance: https://www.klipper3d.org/Pressure_Advance.html
### 3) Skew Correction: https://www.klipper3d.org/Skew_Correction.html
### 4) Resonance Compensation: https://www.klipper3d.org/Resonance_Compensation.html
### RatOS has dedicated macro's to generate shaper graphs for deeper analysis (requires accelerometer).
### Use MEASURE_COREXY_BELT_TENSION to compare tension between belts, and use
### GENERATE_SHAPER_GRAPHS to generate the resonance graphs for analysing and manually entering input shaper
### configuration.
### You can run SHAPER_CALIBRATE to automatically calibrate your input shaper configuration, if you just want
### to get started.
### Additionally, you can use the Realtime Analysis Tool to analyze your printer's performance in real-time.
### Read more about klipper here: https://www.klipper3d.org/Overview.html
#############################################################################################################

#---------------------------------------------------- X -----------------------------------------------------
# The X axis motor for the left toolhead, located at the rear left of the printer
#------------------------------------------------------------------------------------------------------------
[stepper_x]
dir_pin: x_dir_pin                 # Add ! in front of pin name to reverse the direction of stepper_x
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
homing_speed: 50
position_min: -50 
position_max: 305
position_endstop: -50

#---------------------------------------------- DUAL_CARRIAGE -----------------------------------------------
# The X axis motor for the right toolhead, located at the rear right of the printer
#------------------------------------------------------------------------------------------------------------
[dual_carriage]
dir_pin: dual_carriage_dir_pin     # Add ! in front of pin name to reverse the direction of dual_carriage
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
position_min: 0
position_max: 355.1
position_endstop: 355.1
safe_distance: 50

#---------------------------------------------------- Y -----------------------------------------------------
# The Y motor used for bed control
#------------------------------------------------------------------------------------------------------------
[stepper_y]
dir_pin: !y_dir_pin                # Remove ! in front of pin name to reverse the direction of stepper_y
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
position_min: -6.5
position_max: 325
position_endstop: -6.5

#---------------------------------------------------- Z -----------------------------------------------------
# The left Z motor for the toolhead axis
#------------------------------------------------------------------------------------------------------------
[stepper_z]
dir_pin: !z_dir_pin               # Remove ! in front of pin name to reverse the direction of stepper_z
rotation_distance: 8               # 4 for TR8*4 lead screws
homing_speed: 10
position_min: -5
position_max: 250

#---------------------------------------------------- Z1 ----------------------------------------------------
# The right Z motor for the bed
#------------------------------------------------------------------------------------------------------------
[stepper_z1]
dir_pin: z1_dir_pin               # Remove ! in front of pin name to reverse the direction of stepper_z1
rotation_distance: 8               # 4 for TR8*4 lead screws

#------------------------------------------------- EXTRUDER -------------------------------------------------
# The extruder motor used for pushing filament through the left toolhead (T0)
#------------------------------------------------------------------------------------------------------------
[extruder]
dir_pin: !e_dir_pin                # Remove ! in front of pin name to reverse the direction of extruder
#pressure_advance: 0.05            # Check https://www.klipper3d.org/Pressure_Advance.html for pressure advance tuning.

#------------------------------------------------ EXTRUDER1 -------------------------------------------------
# The extruder motor used for pushing filament through the right toolhead (T1)
#------------------------------------------------------------------------------------------------------------
[extruder1]
dir_pin: !e1_dir_pin   # Remove ! in front of pin name to reverse the direction of extruder1
#pressure_advance: 0.05            # Check https://www.klipper3d.org/Pressure_Advance.html for pressure advance tuning.

[heater_bed]
min_temp: 10
max_temp: 120

# Probe configuration
[bltouch]
x_offset: -21.5
y_offset: -21
#z_offset: 3.425 # Will be commented out after a successful PROBE_CALIBRATE and SAVE_CONFIG


[ratos]
allow_unsupported_slicer_versions: True

[exclude_object]
[dual_carriage]
position_max: 355.100
position_endstop: 355.100

[gcode_macro RatOS]
variable_bed_margin_x: [50.000, 50.100]

[gcode_macro _VAOC]
variable_expected_camera_x_position: 152.500
variable_expected_camera_y_position: 152.500

[gcode_macro T0]
variable_parking_position: -48.000

[gcode_macro T1]
variable_parking_position: 353.100


#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 22.923
#*# pid_ki = 2.351
#*# pid_kd = 55.876
#*#
#*# [extruder1]
#*# control = pid
#*# pid_kp = 23.466
#*# pid_ki = 2.407
#*# pid_kd = 57.198
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 59.135
#*# pid_ki = 2.757
#*# pid_kd = 317.113
#*#
#*# [bltouch]
#*# z_offset = 2.450
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.248125, 0.158125, 0.136250, 0.061875, -0.001875, 0.001250, 0.025625, 0.078750, 0.045625, 0.024375, 0.000625, -0.015625, -0.003750, -0.021875, -0.010000, -0.053750, -0.047500, 0.020000, 0.072500, 0.075000
#*# 	  0.256250, 0.168125, 0.074375, 0.060000, -0.010625, -0.020000, 0.031875, 0.028750, 0.066875, -0.004375, -0.026250, -0.016250, -0.047500, -0.025000, -0.043750, -0.094375, -0.053750, -0.036250, -0.008750, 0.070625
#*# 	  0.196250, 0.137500, 0.098125, 0.035000, -0.006875, -0.005625, 0.020625, 0.076250, 0.061250, 0.014375, -0.011875, -0.003750, -0.002500, -0.016250, -0.012500, -0.056250, -0.046875, -0.014375, 0.053125, 0.021875
#*# 	  0.196250, 0.118125, 0.106875, 0.064375, 0.025000, 0.031875, 0.022500, 0.037500, 0.070625, -0.006875, -0.030000, -0.037500, 0.029375, -0.013125, -0.028125, -0.086250, -0.051875, -0.000000, 0.045000, 0.053125
#*# 	  0.181250, 0.086875, 0.120000, 0.103125, 0.039375, 0.034375, 0.034375, 0.066250, 0.075625, 0.033125, -0.013125, 0.115000, 0.035000, -0.007500, -0.046875, -0.084375, -0.011875, 0.020000, 0.023125, 0.052500
#*# 	  0.163750, 0.071875, 0.091875, 0.118125, 0.066875, 0.074375, 0.033750, 0.086250, 0.089375, 0.111875, 0.022500, 0.016875, 0.075625, 0.076250, -0.049375, -0.048750, -0.026250, 0.029375, 0.035000, 0.061250
#*# 	  0.152500, 0.088125, 0.080625, 0.103750, 0.050625, 0.070625, 0.106250, 0.109375, 0.204375, 0.000625, 0.040000, 0.073125, 0.040000, -0.009375, -0.003125, -0.030625, -0.001875, 0.030000, 0.073125, 0.040000
#*# 	  0.137500, 0.074375, 0.114375, 0.081250, 0.056250, 0.072500, 0.097500, 0.160625, 0.126250, 0.132500, 0.022500, -0.028750, 0.035000, 0.075625, -0.039375, -0.032500, 0.027500, 0.065625, 0.082500, 0.072500
#*# 	  0.151250, 0.070000, 0.106250, 0.035625, 0.083750, 0.036250, 0.145000, 0.063750, 0.061875, -0.011875, 0.079375, -0.015625, -0.005000, 0.038125, 0.120625, -0.003750, 0.033125, 0.121875, 0.092500, 0.108750
#*# 	  0.143750, 0.125625, 0.129375, 0.146250, 0.105000, 0.110625, 0.090625, 0.071250, 0.056875, 0.020000, 0.071875, -0.000625, 0.070000, 0.033750, 0.030625, 0.033125, 0.071875, 0.106250, 0.153750, 0.090625
#*# 	  0.160000, 0.101875, 0.121250, 0.078125, 0.036250, 0.026250, -0.000000, 0.033750, 0.030625, 0.059375, 0.023750, 0.036250, 0.099375, 0.064375, 0.002500, 0.026250, 0.030625, 0.066875, 0.231250, 0.103750
#*# 	  0.148750, 0.081875, 0.088750, 0.078125, 0.056875, 0.091875, 0.033750, 0.101250, 0.022500, 0.068750, 0.033125, 0.075000, 0.081875, 0.235625, 0.031250, 0.038125, 0.080000, 0.115625, 0.181875, 0.156250
#*# 	  0.183750, 0.118125, 0.128750, 0.180625, 0.063750, 0.143125, 0.118750, 0.058750, 0.062500, 0.063750, 0.112500, 0.071875, 0.143750, 0.033750, 0.185625, 0.033750, 0.065000, 0.152500, 0.163750, 0.180625
#*# 	  0.175000, 0.100625, 0.185000, 0.067500, 0.094375, 0.063750, 0.054375, 0.143125, 0.183750, 0.210625, 0.066250, 0.081250, 0.066875, 0.225000, 0.035625, 0.032500, 0.111250, 0.148750, 0.181250, 0.183750
#*# 	  0.153750, 0.080625, 0.075000, 0.066875, 0.019375, 0.027500, 0.105625, 0.066875, 0.033750, 0.077500, 0.066250, 0.029375, 0.100000, 0.075000, -0.003750, 0.066250, 0.106250, 0.177500, 0.172500, 0.177500
#*# 	  0.191875, 0.106250, 0.108750, 0.067500, 0.030000, 0.015625, -0.005000, 0.024375, 0.058125, 0.096875, -0.015625, -0.005625, 0.026875, 0.031875, -0.005625, 0.030000, 0.076250, 0.156875, 0.151250, 0.153125
#*# 	  0.212500, 0.165625, 0.135000, 0.073750, 0.038750, 0.013750, 0.002500, 0.058125, 0.067500, 0.101875, 0.026875, 0.024375, 0.035000, 0.026875, 0.035000, 0.055625, 0.068125, 0.113125, 0.133750, 0.179375
#*# 	  0.225625, 0.148750, 0.149375, 0.114375, 0.065000, 0.028125, -0.003125, 0.020000, 0.018750, 0.036250, 0.056875, 0.061250, 0.104375, 0.035000, -0.003125, 0.038750, 0.035000, 0.112500, 0.163125, 0.175000
#*# 	  0.233125, 0.199375, 0.130000, 0.071875, 0.034375, -0.001875, 0.008125, 0.023125, 0.051250, 0.060625, 0.077500, 0.113125, 0.118125, 0.078750, 0.080625, 0.078125, 0.073750, 0.150000, 0.187500, 0.191250
#*# 	  0.284375, 0.230625, 0.141250, 0.086875, 0.053125, 0.021875, 0.028750, 0.034375, 0.068125, 0.070625, 0.066875, 0.078125, 0.071250, 0.090000, 0.080000, 0.066250, 0.115625, 0.143750, 0.190000, 0.191250
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 279.99
#*# min_y = 10.0
#*# max_y = 279.99000000000007
