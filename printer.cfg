#############################################################################################################
### CONFIGURATION GENERATED BY THE RATOS CONFIGURATOR
### Everything below [include RatOS.cfg] will override default RatOS behavior
#############################################################################################################
[include v-cast-idex-RatOS.cfg]

#############################################################################################################
### MACRO CONFIGURATION
### Configure the behavior of RatOS macros
### See: https://os.ratrig.com/docs/configuration/macros
#############################################################################################################
[gcode_macro RatOS]
variable_relative_extrusion: True
variable_preheat_extruder: True
variable_calibrate_bed_mesh: True
variable_nozzle_priming: "primeblob"
variable_start_print_park_in: "front"
variable_start_print_park_z_height: 50
variable_end_print_park_in: "back"
variable_pause_print_park_in: "front"

#############################################################################################################
### USER OVERRIDES & CUSTOM CONFIGURATION
### Anything custom you want to add, or RatOS configuration you want to override, do it here.
### This section is pre-populated with the most common settings you may want to change.
### See: https://os.ratrig.com/docs/configuration/includes-and-overrides
###
### It is recommended that you follow these steps to properly calibrate your printer:
### 0) Sanity check and PID Tuning: https://www.klipper3d.org/Config_checks.html
### 1) Z-offset calibration: https://www.klipper3d.org/Probe_Calibrate.html#calibrating-probe-z-offset
### 2) Pressure Advance: https://www.klipper3d.org/Pressure_Advance.html
### 3) Skew Correction: https://www.klipper3d.org/Skew_Correction.html
### 4) Resonance Compensation: https://www.klipper3d.org/Resonance_Compensation.html
### RatOS has dedicated macro's to generate shaper graphs for deeper analysis (requires accelerometer).
### Use MEASURE_COREXY_BELT_TENSION to compare tension between belts, and use
### GENERATE_SHAPER_GRAPHS to generate the resonance graphs for analysing and manually entering input shaper
### configuration.
### You can run SHAPER_CALIBRATE to automatically calibrate your input shaper configuration, if you just want
### to get started.
### Additionally, you can use the Realtime Analysis Tool to analyze your printer's performance in real-time.
### Read more about klipper here: https://www.klipper3d.org/Overview.html
#############################################################################################################

#---------------------------------------------------- X -----------------------------------------------------
# The X axis motor for the left toolhead, located at the rear left of the printer
#------------------------------------------------------------------------------------------------------------
[stepper_x]
dir_pin: x_dir_pin                 # Add ! in front of pin name to reverse the direction of stepper_x
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
homing_speed: 50
position_min: -50 
position_max: 305
position_endstop: -50

#---------------------------------------------- DUAL_CARRIAGE -----------------------------------------------
# The X axis motor for the right toolhead, located at the rear right of the printer
#------------------------------------------------------------------------------------------------------------
[dual_carriage]
dir_pin: dual_carriage_dir_pin     # Add ! in front of pin name to reverse the direction of dual_carriage
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
position_min: 0
position_max: 355.1
position_endstop: 355.1
safe_distance: 50

#---------------------------------------------------- Y -----------------------------------------------------
# The Y motor used for bed control
#------------------------------------------------------------------------------------------------------------
[stepper_y]
dir_pin: !y_dir_pin                # Remove ! in front of pin name to reverse the direction of stepper_y
rotation_distance: 40              # 40 for 20 tooth 2GT pulleys, 32 for 16 tooth 2GT pulleys
position_min: -6.5
position_max: 325
position_endstop: -6.5

#---------------------------------------------------- Z -----------------------------------------------------
# The left Z motor for the toolhead axis
#------------------------------------------------------------------------------------------------------------
[stepper_z]
dir_pin: !z_dir_pin               # Remove ! in front of pin name to reverse the direction of stepper_z
rotation_distance: 8               # 4 for TR8*4 lead screws
homing_speed: 10
position_min: -5
position_max: 250

#---------------------------------------------------- Z1 ----------------------------------------------------
# The right Z motor for the bed
#------------------------------------------------------------------------------------------------------------
[stepper_z1]
dir_pin: z1_dir_pin               # Remove ! in front of pin name to reverse the direction of stepper_z1
rotation_distance: 8               # 4 for TR8*4 lead screws

#------------------------------------------------- EXTRUDER -------------------------------------------------
# The extruder motor used for pushing filament through the left toolhead (T0)
#------------------------------------------------------------------------------------------------------------
[extruder]
dir_pin: !e_dir_pin                # Remove ! in front of pin name to reverse the direction of extruder
#pressure_advance: 0.05            # Check https://www.klipper3d.org/Pressure_Advance.html for pressure advance tuning.

#------------------------------------------------ EXTRUDER1 -------------------------------------------------
# The extruder motor used for pushing filament through the right toolhead (T1)
#------------------------------------------------------------------------------------------------------------
[extruder1]
dir_pin: !e1_dir_pin   # Remove ! in front of pin name to reverse the direction of extruder1
#pressure_advance: 0.05            # Check https://www.klipper3d.org/Pressure_Advance.html for pressure advance tuning.

[heater_bed]
min_temp: 10
max_temp: 120

# Probe configuration
[bltouch]
x_offset: -21.5
y_offset: -21
#z_offset: 3.425 # Will be commented out after a successful PROBE_CALIBRATE and SAVE_CONFIG

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 22.923
#*# pid_ki = 2.351
#*# pid_kd = 55.876
#*#
#*# [extruder1]
#*# control = pid
#*# pid_kp = 23.466
#*# pid_ki = 2.407
#*# pid_kd = 57.198
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 59.135
#*# pid_ki = 2.757
#*# pid_kd = 317.113
#*#
#*# [bltouch]
#*# z_offset = 4.025
